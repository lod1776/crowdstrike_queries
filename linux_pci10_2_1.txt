// Linux File Access to Cardholder Data Directories
#event_simpleName=ProcessRollup2 OS=Linux
| search(CommandLine, pattern="(?i)(cat|less|more|tail|head|vim|nano|vi).*(/cardholder/|/chd/|/payment_data/|card.*data)")
| UserName!="-" AND UserName!="root" AND UserName!="daemon"

// Linux File Operations on CHD Files
#event_simpleName in(values=[FileOpenInfo, FileWritten, FileDeleted, FileCreated]) OS=Linux
| search(TargetFileName, pattern="(?i)(/var/cardholder/|/opt/chd/|/data/payment/|card.*data|/.*cardholder.*|\\d{13,19})")
| UserName!="-" AND UserName!="root"

// Linux Database Query Access (MySQL/PostgreSQL)
#event_simpleName=ProcessRollup2 OS=Linux
| search(CommandLine, pattern="(?i)(mysql|psql|sqlite3).*(cardholder|payment|card_data|SELECT.*FROM.*card)")
| UserName!="-" AND UserName!="root" AND UserName!="mysql" AND UserName!="postgres"

// Linux Direct File Read/Write to CHD Paths
#event_simpleName=ProcessRollup2 OS=Linux
| search(CommandLine, pattern="(?i)(cp|mv|rsync|scp).*(/cardholder|/chd|/payment|card_data)")
| UserName!="-" AND UserName!="root"

// Linux Application Access to CHD (Web Servers, APIs)
#event_simpleName=ProcessRollup2 OS=Linux
FileName in(values=[apache2, httpd, nginx, java, python, node])
| search(CommandLine, pattern="(?i)(cardholder|payment|chd|card.*data|/api/.*card)")
| UserName!="-"

// Linux Audit Events - File Access
#event_simpleName=AuditdFileAccessEvent
| search(FilePath, pattern="(?i)(/cardholder/|/chd/|/payment/|card.*data)")
| UserName!="-" AND UserName!="root"